{"version":3,"sources":["scripts/app.js"],"names":["angular","module","SubmitStoryController","story","$rootScope","$q","$timeout","vm","this","hasBackground","customContainer","hero","title","text","beforeHero","afterHero","heathrow_origin","getFileBase64FromFileAsync","file","deferred","defer","fileReader","FileReader","readAsDataURL","onload","e","resolve","target","result","promise","submitForm","form","form1","$valid","image","then","imageData","save","isSubmitted","forEach","$error","required","field","$setDirty","element","animate","scrollTop","parent","offset","top","yearOrder","endYear","Date","getFullYear","startYear","trip_date","dateSelector","days","nbDays","year","month","getDate","daysList","i","iS","toString","push","length","months","monthList","years","yearsList","$inject","controller","StoryController","$stateParams","slug","constructDate","trip_day","trip_month","trip_year","date","sendStoryData","$broadcast","from","journeyStart","getStoryById","data","MainController","homepage","createHomepage","cards","StaticController","page","getPageById","GiftsController","gift","subTitle","content","createGiftsPage","GiftController","$log","getGiftById","log","storyHeader","StoryHeaderController","$scope","$sce","initVideoPlayer","onPlayerReady","event","playVideo","videoActive","$apply","onPlayerStateChange","YT","PlayerState","ENDED","done","exitFullScreen","tag","document","createElement","firstScriptTag","getElementsByTagName","src","parentNode","insertBefore","player","window","onYouTubeIframeAPIReady","Player","height","width","videoId","youtube_id","events","onReady","onStateChange","initFullScreen","elem","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","$document","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","hasVideo","getBackground","getVideoSrc","trustAsResourceUrl","console","directive","restrict","templateUrl","scope","controllerAs","bindToController","storyContent","StoryContentController","hasField","hasCopy","copy","getSoundcloudUrl","id","getParagraphs","split","getFirstParagraph","getOtherParagraphs","paragraphs","slice","getSafeHtml","handleTitleInView","on","isInView","share","ShareController","$element","$window","makeItemSticky","$shareWrapper","find","scrollY","addClass","removeClass","init","$media","cardsInView","viewHeight","Math","max","documentElement","clientHeight","innerHeight","parallax","itemPos","getBoundingClientRect","elBackgroundPos","query","style","backgroundPosition","startParallax","item","card","currentTarget","locationInView","indexOf","splice","bind","pageContent","PageContentController","getSafeContent","link","$last","$emit","acmeNavbar","NavbarController","$location","setStoryPage","locationPath","path","locationMain","locationSub","navAlwaysVisible","isStoryPage","navbar","handleInViewBehaviour","handleStoryVisibility","deregisterationCallback","$on","ev","visible","updateStoryTitle","args","storyInfo","creationDate","setInfoPosition","colWidth","largeBlock","smallBlock","contentBlock","ctaBlock","ctaBorder","jss","set","padding-top","ctas","threshold","left","right","cta","ctaPosition","position","nextElement","next","mason","itemSelector","ratio","promoted","columns","filler","filler_class","gutter","layout","source","type","canvas","ctx","getContext","img","setAttribute","beginPath","moveTo","lineTo","closePath","clip","drawImage","restore","toDataURL","giftsBlock","giftHeader","GiftHeaderController","logo","footer","FooterController","giftContent","GiftContentController","carousel","CarouselController","initCarousel","c","slick","prevArrow","nextArrow","beforeChange","currentSlide","nextSlide","updatePage","newPage","images","storyBlock","cardsBlock","CardsController","snippetBlock","SnippetController","QuoteBlock","QuoteController","block","giftHeroBlock","giftBlock","CtaBlock","CtaController","$resource","storyApi","method","get","$promise","getAll","storyData","newStory","$save","service","pageApi","Media","shortcuts","tablet","screen-xs","screen-sm","screen-md","screen-ld","shortcut","raw","raw_query","value","matchMedia","matches","onresize","factory","Service","createCard","type_mapping","feature_gift","gift_small","gift_hero","story_cta","gift_cta","featured","quote","snippet","className","background","background-image","mapCards","api","getData","display_as","filter","replace","trustAsHtml","list","runBlock","run","routerConfig","$stateProvider","$urlRouterProvider","state","url","otherwise","config","constant","malarkey","moment","$logProvider","toastrConfig","$httpProvider","$locationProvider","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","$cookies","injector","invoke","_$cookies_","defaults","headers","post","X-CSRFToken","Content-Type","rule","$injector","hasTrailingSlash","newPath","substr","html5Mode","$templateCache","put"],"mappings":"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","file":"scripts/app-04cd4ca543.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('lhr70', ['ngAnimate', 'ngCookies', 'ngTouch',\n      'ngSanitize', 'ngMessages', 'ngAria', 'ngResource',\n      'ui.router', 'toastr', 'slidePushMenu',\n      'ngFileUpload']);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('SubmitStoryController', SubmitStoryController);\n\n  /** @ngInject */\n  function SubmitStoryController(story, $rootScope, $q, $timeout) {\n\n    var vm = this;\n    $rootScope.hasBackground = true;\n    $rootScope.customContainer = true;\n\n\n    $rootScope.hero = {\n      title: \"Where has Heathrow taken you?\",\n      text: {\n        beforeHero: \"\",\n        afterHero: [\"Use the 6 questions below to tell us as much as you can about where Heathrow has taken you.\",\n          \"You do not need to answer every question but the more information you can give us the better your story will be.\",\n          \"And the better your story is the better the gift you will receive.\"]\n      }\n    };\n\n    vm.story = {\n      heathrow_origin: null\n    };\n\n    var getFileBase64FromFileAsync = function (file) {\n      var deferred = $q.defer();\n      var fileReader = new FileReader();\n      fileReader.readAsDataURL(file);\n      fileReader.onload = function (e) {\n        deferred.resolve(e.target.result);\n      };\n      return deferred.promise;\n    };\n\n    vm.submitForm = function (form, form1) {\n      if (form.$valid && form1.$valid) {\n        if (vm.image) {\n          getFileBase64FromFileAsync(vm.image).then(\n            function (imageData) {\n              vm.story.image = imageData;\n              story.save(vm.story).then(function () {\n                vm.isSubmitted = true;\n              });\n            });\n        } else {\n          story.save(vm.story).then(function () {\n            vm.isSubmitted = true;\n          });\n        }\n      } else {\n        angular.forEach(form.$error.required, function (field) {\n          field.$setDirty();\n        });\n        angular.forEach(form1.$error.required, function (field) {\n          field.$setDirty();\n        });\n        $timeout(function () {\n          angular.element('html, body').animate({\n            scrollTop: angular.element('.to-fix:first').parent().offset().top - 80\n          }, 250);\n        }, 250);\n      }\n    };\n\n    // ATTRIBUTES (with default values if not set)\n    vm.yearOrder = true; // year order: 'asc' or 'desc', default: desc\n    var endYear = new Date().getFullYear(); // default: this year\n    var startYear = endYear - 100; // default: this year - 100\n\n    vm.trip_date = new Date();\n\n    // INIT YEARS, MONTHS AND DAYS NUMBER\n    vm.dateSelector = {\n\n      days: function () {\n\n        // Get number of days based on month + year\n        // (January = 31, February = 28, April = 30, February 2000 = 29) or 31 if no month selected yet\n        var nbDays = new Date(vm.trip_date.year, vm.trip_date.month, 0).getDate() || 31;\n\n        var daysList = [];\n        for (var i = 1; i <= nbDays; i++) {\n          var iS = i.toString();\n          daysList.push((iS.length < 2) ? '0' + iS : iS); // Adds a leading 0 if single digit\n        }\n        return daysList;\n      },\n      months: function () {\n        var monthList = [];\n        for (var i = 1; i <= 12; i++) {\n          var iS = i.toString();\n          monthList.push((iS.length < 2) ? '0' + iS : iS); // Adds a leading 0 if single digit\n        }\n        return monthList;\n      },\n      years: function () {\n        var yearsList = [];\n        for (var i = endYear; i >= startYear; i--) {\n          yearsList.push(i.toString());\n        }\n        return yearsList;\n      }\n    };\n\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('StoryController', StoryController);\n\n  /** @ngInject */\n  function StoryController(story, $rootScope, $stateParams) {\n\n    var vm = this;\n\n    var slug = $stateParams.slug;\n\n    var constructDate = function() {\n      if(vm.story.trip_day || vm.story.trip_month || vm.story.trip_year) {\n        vm.story.date = \"\";\n        if (vm.story.trip_day) vm.story.date += vm.story.trip_day + \".\";\n        if (vm.story.trip_month) vm.story.date += vm.story.trip_month + \".\";\n        if (vm.story.trip_year) vm.story.date += vm.story.trip_year;\n      }\n    }\n\n    var sendStoryData = function () {\n      // send title to navigation\n      // TODO: might need to be added into a location change event listener\n      $rootScope.$broadcast('STORY_TITLE_CHANGE', {\n        from: vm.story.journeyStart,\n        title: vm.story.title,\n        date: vm.story.date\n      });\n    }\n\n    story.getStoryById(slug).then(function (data) {\n      vm.story = data;\n      constructDate();\n      sendStoryData();\n    });\n\n    //var stry = \"Lorem ipsum dolor sit amet, eum te ullum corpora, prima posse postea eu per. Ex duo malis facilis referrentur. Eam eu utamur tractatos mediocrem. Pri te dolor conceptam. Omnis inciderint accommodare at mel. Mei ex nonumy percipitur dissentias, sonet signiferumque ex cum. Cu his aliquam indoctum, per ad eleifend expetendis, labitur erroribus interesset ad qui. Eos ei sumo appetere definiebas, agam probatus sed ea. Fastidii placerat accusamus ei duo, mel id detracto tacimates expetendis, affert disputando an eam. No meis omnis virtute ius, in duo laudem elaboraret. Idque doming dolores te nec. An vim ocurreret prodesset scribentur.Mundi reprimique ut has, mei prompta appellantur philosophia te. Molestie facilisi vim eu, quis dicat civibus in eam. No nam liber choro, an aliquip alterum consequat sit. Prima noster in vim, cibo labores torquatos qui in. Assum corrumpit efficiantur mea id.\"\n\n    // vm.story = {\n    //   title: \"To conquer the world!!!!!!!\",\n    //   heathrow_origin: true,\n    //   trip_year: 1991,\n    //   trip_month: 12,\n    //   trip_day: 5,\n    //   person: {name: \"the beatles\"},\n    //   journeyStart: 'LHR',\n    //   journeyEnd: 'LAX',\n    //   soundcloud: '208577499',\n    //   image: 'http://www.intrawallpaper.com/static/images/abstract-mosaic-background.png',\n    //   details: stry\n    // };\n\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(homepage, $rootScope) {\n    var vm = this;\n    $rootScope.hasBackground = true;\n    homepage.createHomepage().then(function (data) {\n      vm.cards = data;\n    });\n\n    $rootScope.hero = {\n      title: \"Where has Heathrow taken you?\",\n      text: {\n        beforeHero: [\"This year we're celebrating 70 years of beautiful journeys\",\n          \"Taking the world to  family reunions, new careers & even coronations,\"],\n        afterHero: [\"Add your story and we'll give you a birthday gift\"]\n      }\n    };\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('StaticController', StaticController);\n\n  /** @ngInject */\n  function StaticController(page, $stateParams) {\n\n    var vm = this;\n\n    var slug = $stateParams.slug;\n\n    page.getPageById(slug).then(function (data) {\n      vm.page = data;\n    });\n\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('GiftsController', GiftsController);\n\n  /** @ngInject */\n  function GiftsController(gift, $rootScope) {\n    var vm = this;\n    $rootScope.hasBackground = true;\n    $rootScope.hero = {\n      title: \"Gifts?\",\n      subTitle: \"Birthday\",\n      text: {\n        content: [\"We have joined forces with some of our favourite partners to be able to offer you some of the best gifts. \" +\n        \"All you have to do to receive one of these is tell us where heathrow has taken you.\"]\n      }\n    };\n    gift.createGiftsPage().then(function (data) {\n      vm.cards = data;\n    })\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .controller('GiftController', GiftController);\n\n  /** @ngInject */\n  function GiftController(gift, $stateParams, $log) {\n\n    var vm = this;\n\n    var slug = $stateParams.slug;\n\n    gift.getGiftById(slug).then(function (data) {\n      vm.gift = data;\n      $log.log('gift', vm.gift);\n    });\n  }\n})();\n\n/* global YT */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('storyHeader', storyHeader);\n\n  /** @ngInject */\n  function storyHeader() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/storyHeader/storyHeader.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: StoryHeaderController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function StoryHeaderController($scope, $sce) {\n\n      var vm = this;\n\n      var initVideoPlayer = function() {\n        // 2. This code loads the IFrame Player API code asynchronously.\n        var tag = document.createElement('script');\n        var firstScriptTag = document.getElementsByTagName('script')[0];\n\n        tag.src = \"https://www.youtube.com/iframe_api\";\n\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n\n        // 3. This function creates an <iframe> (and YouTube player)\n        //    after the API code downloads.\n        var player;\n\n        window.onYouTubeIframeAPIReady = function() {\n          player = new YT.Player('player', {\n            height: '100%',\n            width: '100%',\n            videoId: vm.story.youtube_id,\n            events: {\n              'onReady': onPlayerReady,\n              'onStateChange': onPlayerStateChange\n            }\n          });\n        }\n\n        // 4. The API will call this function when the video player is ready.\n        function onPlayerReady(event) {\n          event.target.playVideo();\n          $scope.videoActive = true;\n          $scope.$apply();\n        }\n\n        // 5. The API calls this function when the player's state changes.\n        //    The function indicates that when playing a video (state=1),\n        //    the player should play for six seconds and then stop.\n        var done = false;\n\n        function onPlayerStateChange(event) {\n          if (event.data == YT.PlayerState.ENDED && !done) {\n            exitFullScreen();\n            done = true;\n          }\n        }\n\n        // function stopVideo() {\n        //   player.stopVideo();\n        // }\n      }\n\n      var initFullScreen = function() {\n        var elem = angular.element(\".story-video\")[0];\n        if (elem.requestFullscreen) {\n          elem.requestFullscreen();\n        } else if (elem.msRequestFullscreen) {\n          elem.msRequestFullscreen();\n        } else if (elem.mozRequestFullScreen) {\n          elem.mozRequestFullScreen();\n        } else if (elem.webkitRequestFullscreen) {\n          elem.webkitRequestFullscreen();\n        }\n      };\n\n      var exitFullScreen = function() {\n        if ($document.exitFullscreen) {\n          $document.exitFullscreen();\n        } else if ($document.msExitFullscreen) {\n          $document.msExitFullscreen();\n        } else if ($document.mozCancelFullScreen) {\n          $document.mozCancelFullScreen();\n        } else if ($document.webkitExitFullscreen) {\n          $document.webkitExitFullscreen();\n        }\n      };\n\n      $scope.hasVideo = function() {\n        return vm.story && vm.story.youtube_id !== null && typeof vm.story.youtube_id !== 'undefined'\n      }\n\n      $scope.getBackground = function(image) {\n        return 'background-image: url(' + image + ')';\n      }\n\n      $scope.getVideoSrc = function() {\n        return $sce.trustAsResourceUrl('http://www.youtube.com/embed/' + vm.story.youtube_id + '?autoplay=1');\n      }\n\n      $scope.playVideo = function() {\n        // $scope.videoActive = true;\n        //\n        // // TODO: remove real functionality\n        // vm.story.youtubeId = 'Nck6BZga7TQ';\n        // //console.log(\"TODO: play video functionality\");\n\n        console.log('blah');\n\n        initFullScreen();\n        initVideoPlayer();\n      }\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('storyContent', storyContent);\n\n  /** @ngInject */\n  function storyContent() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/storyContent/storyContent.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: StoryContentController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    function StoryContentController($scope, $sce, $rootScope) {\n      $scope.hasField = function(field) {\n        return typeof field !== \"undefined\" && field !== null;\n      }\n\n      $scope.hasCopy = function(copy) {\n        return typeof copy !== \"undefined\" && copy !== null;\n      }\n\n      $scope.getSoundcloudUrl = function(id) {\n        return $sce.trustAsResourceUrl(\"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/\" + id +\n                \"&amp;color=350083&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false\");\n      }\n\n      $scope.getParagraphs = function(copy) {\n        return copy ? copy.split(\"\\n\") : [];\n      }\n\n      $scope.getFirstParagraph = function(copy) {\n        return $scope.getParagraphs(copy)[0];\n      }\n\n      $scope.getOtherParagraphs = function(copy) {\n        var paragraphs = $scope.getParagraphs(copy);\n        return paragraphs.slice(1, paragraphs.length);\n      }\n\n      $scope.getSafeHtml = function(copy) {\n        return $sce.trustAsResourceUrl(copy);\n      }\n\n      var handleTitleInView = function() {\n        angular.element('.story-title').on('inview', function (event, isInView) {\n          $rootScope.$broadcast('STORY_SHOW_TITLE_IN_NAV', !isInView);\n        });\n      }\n\n      handleTitleInView();\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('share', share);\n\n  /** @ngInject */\n  function share() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/share/share.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: ShareController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    function ShareController($element, $window) {\n      var makeItemSticky = function() {\n        var $shareWrapper = $element.find('.story-share-wrapper');\n\n        angular.element($window).on('scroll', function() {\n\n          if ($element.offset().top - $window.scrollY < 125) {\n            $shareWrapper.addClass('is-sticky');\n          } else {\n            $shareWrapper.removeClass('is-sticky');\n          }\n        });\n        // angular.element('.story-title').on('inview', function (event, isInView) {\n        //   $rootScope.$broadcast('STORY_SHOW_TITLE_IN_NAV', !isInView);\n        // });\n      }\n\n      var init = function() {\n        makeItemSticky();\n      }\n\n      init();\n    }\n\n    return directive;\n  }\n})();\n\n/**\n * @ngdoc directive\n * @name lhr70:parallaxDirective\n *\n * @description\n *\n *\n * @restrict A\n * */\nangular.module('lhr70')\n  .directive('cardParallax', function ($window, $document, $timeout,$media) {\n    return function (scope, elem) {\n      var cardsInView = [];\n      var viewHeight = Math.max($document[0].documentElement.clientHeight, $window.innerHeight);\n      var parallax = function (element) {\n        var itemPos = element.getBoundingClientRect(),\n          elBackgroundPos = -(itemPos.top / viewHeight) * 80;\n\n        if($media.query('screen-xs')) {\n          elBackgroundPos = -(itemPos.top / viewHeight) * 80;\n        }\n\n        elBackgroundPos += 80;\n\n        if(elBackgroundPos < 0) {\n          elBackgroundPos = 0;\n        }\n\n        if(elBackgroundPos > 100) {\n          elBackgroundPos = 100;\n        }\n\n        element.style.backgroundPosition = \"50% \" + elBackgroundPos + \"%\";\n\n      };\n      var startParallax = function (cards) {\n        for (var i = 0; i < cards.length; i++) {\n          var item = cards[i];\n          parallax(item);\n        }\n      };\n      $timeout(function () {\n        var cards = angular.element(elem).find('.card');\n        startParallax(cards);\n        for (var i = 0; i < cards.length; i++) {\n          var card = cards[i];\n          angular.element(card).on('inview', function (event, isInView) {\n            if (isInView) {\n              cardsInView.push(event.currentTarget);\n              angular.element(event.currentTarget).addClass('visible');\n            } else {\n              var locationInView = cardsInView.indexOf(event.currentTarget);\n              angular.element(event.currentTarget).removeClass('visible');\n              if (locationInView != -1)\n                cardsInView.splice(locationInView, 1);\n\n            }\n          });\n        }\n        $document.bind('scroll', function () {\n          if (cardsInView.length)\n            startParallax(cardsInView);\n        });\n      }, 0);\n\n    }\n  });\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('pageContent', pageContent);\n\n  /** @ngInject */\n  function pageContent() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/pageContent/pageContent.directive.html',\n      scope: {\n        page: '='\n      },\n      controller: PageContentController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    function PageContentController($scope, $sce, $rootScope) {\n      var vm = this;\n\n      $scope.getSafeContent = function(content) {\n        return $sce.trustAsResourceUrl(content);\n      }\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('onFinishRender', function ($timeout) {\n      return {\n        restrict: 'A',\n        link: function (scope) {\n          if (scope.$last === true) {\n            $timeout(function () {\n              scope.$emit('ngRepeatFinished');\n            });\n          }\n        }\n      }\n    })\n\n  })();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('navbar', acmeNavbar);\n\n  /** @ngInject */\n  function acmeNavbar() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/navbar/navbar.html',\n      scope: {\n        creationDate: '='\n      },\n      controller: NavbarController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    function NavbarController($timeout, $scope, $rootScope, $location) {\n\n      var navbar = angular.element('.navbar');\n\n      /**\n       *  set behaviour for story page\n       *\n       *  @method setStoryPage\n       */\n      function setStoryPage() {\n        var locationPath = $location.path().split('/');\n        var locationMain = locationPath[1];\n        var locationSub = locationPath[2];\n\n        $scope.navAlwaysVisible = locationMain === 'story' && locationSub !== 'submit' || locationMain === 'gift' || locationMain === 'page';\n        $scope.isStoryPage = locationMain === 'story';\n\n        if ($scope.navAlwaysVisible) {\n          navbar.addClass('visible');\n        } else {\n          $timeout(function () {\n            if(!$scope.navAlwaysVisible) {\n\n              handleInViewBehaviour();\n\n            }\n          }, 100);\n        }\n      }\n\n      /**\n       *  set show hide of nav (only for non story pages)\n       *\n       *  @method handleInViewBehaviour\n       */\n      function handleInViewBehaviour() {\n        angular.element('.hero-box').on('inview', function (event, isInView) {\n          $timeout(function () {\n            if (!isInView)\n              navbar.addClass('visible');\n            else {\n              navbar.removeClass('visible');\n            }\n          });\n        });\n      }\n\n      /**\n       *  handle title visibility for story page\n       *\n       *  @method handleStoryVisibility\n       */\n      function handleStoryVisibility() {\n        var deregisterationCallback = $rootScope.$on('STORY_SHOW_TITLE_IN_NAV', function(ev, visible) {\n          if (visible) {\n            navbar.addClass('has-story-info');\n          } else {\n            navbar.removeClass('has-story-info');\n          }\n        });\n\n        $rootScope.$on('$destroy', deregisterationCallback);\n      }\n\n      /**\n       *  update story title\n       *\n       *  @method handleStoryInfoBehaviour\n       */\n      function updateStoryTitle() {\n        // get title from navigation\n        var deregisterationCallback = $rootScope.$on('STORY_TITLE_CHANGE', function(ev, args) {\n          $scope.storyInfo = args;\n        });\n\n        $rootScope.$on('$destroy', deregisterationCallback);\n      }\n\n      /**\n       *  initialise navigation\n       *\n       *  @method init\n       */\n      function init() {\n\n        setStoryPage();\n        handleStoryVisibility();\n\n        $timeout(function () {\n          if(!$scope.navAlwaysVisible) {\n            handleInViewBehaviour();\n          }\n        }, 100);\n\n        updateStoryTitle();\n      }\n\n      init();\n\n\n//      this.toggleMenu = function () {\n//console.log(\"works\");\n//      };\n\n    }\n  }\n\n})();\n\n/**\n * @ngdoc directive\n * @name lhr70:masonDirective\n *\n * @description\n *\n *\n * @restrict A\n * */\nangular.module('lhr70')\n  .directive('masonaryGrid', function ($log, $timeout, $media) {\n    return function (scope, elem) {\n      var setInfoPosition = function () {\n        var colWidth = angular.element(\".card.lg:first\").width();\n        colWidth = (colWidth / 5);\n        var largeBlock, smallBlock, contentBlock, ctaBlock, ctaBorder;\n\n        if ($media.query('tablet')) {\n          largeBlock = {\n            'width': ((colWidth * 4) - 15).toString() + \"px\",\n            'height': (colWidth * 2).toString() + \"px\"\n          };\n          smallBlock = {\n            'width': ((colWidth * 4)).toString() + \"px\",\n            'height': (colWidth * 2).toString() + \"px\"\n          };\n\n          contentBlock = {'height': (colWidth).toString() + \"px\"};\n        } else {\n          largeBlock = {\n            'width': ((colWidth * 5)).toString() + \"px\",\n            'height': (colWidth * 3).toString() + \"px\"\n          };\n          smallBlock = {\n            'width': ((colWidth * 5)).toString() + \"px\",\n            'height': (colWidth * 3).toString() + \"px\"\n          };\n        }\n\n\n        jss.set('.lg .story--copy', largeBlock);\n        jss.set('.sm .story--copy', smallBlock);\n\n        jss.set('.lg .content, .sm .content', contentBlock);\n\n        ctaBlock = {'padding-top': colWidth.toString() + 'px'};\n        jss.set('.cta,.gftCta', ctaBlock);\n\n        if ($media.query('tablet')) {\n          ctaBorder = {'width': ((colWidth * 4)).toString() + \"px\"};\n        } else {\n          ctaBorder = {'width': \"100%\"};\n        }\n        jss.set('.cta-border', ctaBorder);\n\n\n        $timeout(function () {\n          var ctas = angular.element(\".cta,.gftCta\");\n\n          if ($media.query('tablet')) {\n            var width = angular.element(window).width() / 2;\n\n            var threshold = {\n              left: width - (width * 0.55),\n              right: width\n            };\n\n            for (var i = 0; i < ctas.length; i++) {\n              var cta = angular.element(ctas[i]);\n\n              var ctaPosition = cta.position();\n              if (ctaPosition.left > threshold.left && ctaPosition.left < threshold.right) {\n                if (i < ctas.length) {\n                  var nextElement = cta.next();\n                  if (ctaPosition.top == ctaPosition.top) {\n                    nextElement.insertBefore(cta);\n                    ctaPosition = cta.position();\n                  }\n                }\n              }\n              cta.removeClass('left');\n              cta.removeClass('right');\n\n              if (ctaPosition.left > threshold.left) {\n                cta.addClass('right');\n              } else {\n                cta.addClass('left');\n              }\n            }\n          } else {\n            ctas.removeClass('left');\n            ctas.addClass('right');\n          }\n        }, 50);\n      };\n      $timeout(function () {\n        angular.element(elem).mason({\n          itemSelector: '.card',\n          ratio: 1,\n          promoted: [\n            ['lg', 4.9, 5],\n            ['sm', 4.9, 5],\n            ['qt', 4, 4],\n            ['sn', 5, 5],\n            ['cta', 2, 4],\n            ['gftCta', 2, 4],\n            ['gftHero', 11.8, 4],\n            ['gft', 4.9, 5],\n            ['gftLg', 6, 6],\n            ['gftSm', 3.9, 4]\n          ],\n          columns: [\n            [0, 767, 1],\n            [768, 1680, 12]\n          ],\n          filler: {\n            itemSelector: '.filler',\n            filler_class: 'mason-filler'\n          },\n          gutter: 5,\n          layout: 'fluid'\n        }, setInfoPosition)\n      }, 1000);\n    }\n  });\n\n/**\n * @ngdoc directive\n * @name lhr70:imageCropperDirective\n *\n * @description\n *\n *\n * @restrict A\n * */\nangular.module('lhr70')\n  .directive('imageCropper', function ($window, $document, $timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        source: '=',\n        type: '='\n      },\n      link: function (scope, elem) {\n        $timeout(function () {\n          var canvas = angular.element('<canvas></canvas>')[0];\n          var ctx = canvas.getContext('2d');\n          var img = angular.element('<img></img>')[0];\n          img.setAttribute('crossOrigin', 'anonymous');\n          img.src = scope.source;\n\n          // When the image is loaded, draw it\n          img.onload = function () {\n            var height = img.height;\n            var width = img.width;\n\n            canvas.height = height;\n            canvas.width = width;\n\n            // Save the state, so we can undo the clipping\n            ctx.save();\n            ctx.beginPath();\n            if (scope.type == 'gftLg') {\n              ctx.moveTo(width * 0.13, 0);\n              ctx.lineTo(width * 0.28, height * 0.7);\n              ctx.lineTo(width * 0.76, height * 0.85);\n              ctx.lineTo(width, height * 0.61);\n              ctx.lineTo(width, 0);\n            } else if(scope.type == 'header-image'){\n              ctx.moveTo(width * 0.13, 0);\n              ctx.lineTo(width * 0.28, height * 0.7);\n              ctx.lineTo(width * 0.76, height * 0.85);\n              ctx.lineTo(width, height * 0.61);\n              ctx.lineTo(width, 0);\n            } else {\n              ctx.moveTo(width * 0.05, 0);\n              ctx.lineTo(width * 0.33, height * 0.8);\n              ctx.lineTo(width * 0.83, height * 0.95);\n              ctx.lineTo(width, height * 0.8);\n              ctx.lineTo(width, 0);\n            }\n\n            ctx.closePath();\n            //ctx.stroke();\n\n            // Clip to the current path\n            ctx.clip();\n\n            ctx.drawImage(img, 0, 0);\n\n            // Undo the clipping\n            ctx.restore();\n            elem[0].src = canvas.toDataURL(\"image/png\", 100);\n          };\n        }, 0);\n      }\n    };\n  });\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('giftsBlock', giftsBlock);\n\n  /** @ngInject */\n  function giftsBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/gifts/gifts.directive.html',\n      scope: {\n        cards: '='\n      },\n      controller: GiftsController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function GiftsController($log) {\n      $log.log(\"Hello World\");\n    }\n\n    return directive;\n  }\n})();\n\n\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('giftHeader', giftHeader);\n\n  /** @ngInject */\n  function giftHeader() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/giftHeader/giftHeader.directive.html',\n      scope: {\n        image: '=',\n        logo: '='\n      },\n      controller: GiftHeaderController\n    };\n\n    function GiftHeaderController() {\n      // TODO\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('footer', footer);\n\n  /** @ngInject */\n  function footer() {\n    var directive = {\n      restrict: 'A',\n      templateUrl: 'app/components/footer/footer.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: FooterController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function FooterController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('giftContent', giftContent);\n\n  /** @ngInject */\n  function giftContent() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/giftContent/giftContent.directive.html',\n      scope: {\n        gift: '='\n      },\n      controller: GiftContentController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    function GiftContentController($scope, $sce, $rootScope) {\n      $scope.hasField = function(field) {\n        return field && field.length > 0;\n      }\n\n      $scope.getSoundcloudUrl = function(id) {\n        return $sce.trustAsResourceUrl(\"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/\" + id +\n                \"&amp;color=350083&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false\");\n      }\n\n      var handleTitleInView = function() {\n        angular.element('.gift-title').on('inview', function (event, isInView) {\n          $rootScope.$broadcast('STORY_SHOW_TITLE_IN_NAV', !isInView);\n        });\n      }\n\n      handleTitleInView();\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('carousel', carousel);\n\n  /** @ngInject */\n  function carousel() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/carousel/carousel.directive.html',\n      scope: {\n        images: '='\n      },\n      controller: CarouselController\n    };\n\n    function CarouselController($scope, $timeout) {\n\n      var initCarousel = function() {\n        var c = angular.element('.carousel-inner').slick({\n          prevArrow: angular.element('.carousel-prev'),\n          nextArrow: angular.element('.carousel-next'),\n          event: {\n            beforeChange: function (event, slick, currentSlide, nextSlide) {\n              updatePage(nextSlide);\n            }\n          }\n        });\n\n        c.on('beforeChange', function(event, slick, currentSlide, nextSlide) {\n\n          updatePage(nextSlide);\n\n        });\n      }\n\n      var updatePage = function(newPage) {\n        angular.element('.carousel-current').addClass('is-animating');\n\n        $timeout(function() {\n\n          $scope.currentSlide = newPage;\n          $scope.$apply();\n          angular.element('.carousel-current').removeClass('is-animating');\n\n        }, 300);\n      }\n\n      var init = function() {\n        $scope.currentSlide = 0;\n\n        $scope.$on('ngRepeatFinished', function() {\n          initCarousel();\n        });\n      }\n\n      init();\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('storyBlock', storyBlock);\n\n  /** @ngInject */\n  function storyBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardStory/story.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: StoryController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function StoryController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('cardsBlock', cardsBlock);\n\n  /** @ngInject */\n  function cardsBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cards/cards.directive.html',\n      scope: {\n        cards: '='\n      },\n      controller: CardsController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function CardsController() {\n\n    }\n\n    return directive;\n  }\n})();\n\n\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('snippetBlock', snippetBlock);\n\n  /** @ngInject */\n  function snippetBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardSnippet/snippet.directive.html',\n      scope: {\n        story: '='\n      },\n      controller: SnippetController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function SnippetController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('quoteBlock', QuoteBlock);\n\n  /** @ngInject */\n  function QuoteBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardQuote/quote.directive.html',\n      scope: {\n        story: '=',\n        block: '='\n      },\n      controller: QuoteController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function QuoteController() {\n\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('giftHeroBlock', giftHeroBlock);\n\n  /** @ngInject */\n  function giftHeroBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardGiftHero/giftHero.directive.html',\n      scope: {\n        gift: '='\n      },\n      controller: GiftController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function GiftController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('giftBlock', giftBlock);\n\n  /** @ngInject */\n  function giftBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardGift/gift.directive.html',\n      scope: {\n        gift: '='\n      },\n      controller: GiftController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function GiftController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .directive('ctaBlock', CtaBlock);\n\n  /** @ngInject */\n  function CtaBlock() {\n    var directive = {\n      restrict: 'EA',\n      templateUrl: 'app/components/cardCta/cta.directive.html',\n      scope: {\n        type: '='\n      },\n      controller: CtaController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    /** @ngInject */\n    function CtaController() {\n    }\n\n    return directive;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .service('story', story);\n\n  /** @ngInject */\n  function story($resource) {\n\n    var storyApi = $resource(\n      '/api/story/:id',\n      {},\n      {\n        save: {\n          method: 'POST'\n        }\n      }\n    );\n\n    return {\n      getStoryById: function (id) {\n        return storyApi.get({id:id}).$promise;\n      },\n      getAll:  function () {\n        return storyApi.query().$promise;\n      },\n      save: function (storyData) {\n        var newStory = new storyApi(storyData);\n        return newStory.$save();\n      }\n    };\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .service('page', page);\n\n  /** @ngInject */\n  function page($resource) {\n\n    var pageApi = $resource(\n      '/api/page/:id',\n      {},\n      {\n        save: {\n          method: 'POST'\n        }\n      }\n    );\n\n    return {\n      getPageById: function (id) {\n        return pageApi.get({id:id}).$promise;\n      },\n      getAll:  function () {\n        return pageApi.query().$promise;\n      }\n    };\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .service('$media', $media)\n    .factory('Media', Media);\n\n  /** @ngInject */\n  function $media(Media, $rootScope, $window) {\n    var shortcuts = {\n      'tablet': '(min-width: 768px)',\n      'screen-xs': '(max-width:767px)',\n      'screen-sm': '(min-width:768px) and (max-width:991px)',\n      'screen-md': '(min-width:992px) and (max-width:1199px)',\n      'screen-ld': '(min-width:1200px)'\n    };\n\n    return {\n      query: function (shortcut) {\n        return this.raw(shortcuts[shortcut]);\n      },\n      raw: function (raw_query) {\n        Media.value = $window.matchMedia(raw_query).matches;\n        $window.onresize = function () {\n          Media.value = $window.matchMedia(raw_query).matches;\n          $rootScope.$apply();\n        };\n        return Media.value;\n      }\n    }\n  }\n\n\n  function Media() {\n    return {};\n  }\n\n})();\n\n/**\n * @ngdoc service\n * @name lhr70:mapCardFactory\n *\n * @description\n *\n *\n * */\nangular.module('lhr70')\n    .factory('mapCards', function(){\n\n    var Service = {};\n      Service.createCard = function (type, data) {\n        var type_mapping = {\n          gift: 'gft',\n          feature_gift: 'gftLg',\n          gift_small: 'gftSm',\n          gift_hero: 'gftHero',\n          story_cta: 'cta',\n          gift_cta: 'gftCta',\n          image: 'sm',\n          featured: 'lg',\n          quote: 'qt',\n          snippet: 'sn'\n        };\n\n        if (typeof(data) != 'undefined') {\n          data.className = type_mapping[type];\n          if (data.image !== null && (type == \"image\" || type == \"featured\")) {\n            data.background = {'background-image': 'url(' + data.image + ')'};\n          }\n        } else {\n          data = {className: type_mapping[type]};\n        }\n\n        return data\n      };\n\n    return Service;\n});\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .service('homepage', homepage);\n\n  /** @ngInject */\n  function homepage($resource, mapCards, $q) {\n\n    var api = $resource('/api/home/');\n\n    return {\n      getData: function () {\n        return api.query().$promise;\n      },\n      createHomepage: function () {\n        var deferred = $q.defer();\n\n        this.getData().then(function (data) {\n          var cards = [];\n\n          for (var i = 0; i < data.length; i++) {\n            var item = data[i];\n            cards.push(mapCards.createCard(item.display_as, item));\n            if (i > 4) {\n              if (i % 3 == 0) {\n                if (i % 2 == 0)\n                  cards.push(mapCards.createCard('gift_cta'));\n                else {\n                  cards.push(mapCards.createCard('story_cta'));\n                }\n              }\n            }\n          }\n          deferred.resolve(cards);\n        });\n\n        return deferred.promise;\n      }\n    };\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .service('gift', gift);\n\n  /** @ngInject */\n  function gift($resource, $q, mapCards) {\n\n    var api = $resource('/api/gift/:id');\n\n    return {\n      getGiftById: function (id) {\n        return api.get({id:id}).$promise;\n      },\n      getAll:  function () {\n        return api.query().$promise;\n      },\n      createGiftsPage: function () {\n        var deferred = $q.defer();\n\n        this.getAll().then(function (data) {\n          var cards = [];\n\n          cards.push(mapCards.createCard(\"gift_hero\", data[0]));\n          for (var i = 1; i < data.length; i++) {\n            var item = data[i];\n\n            cards.push(mapCards.createCard(\"gift_small\", item));\n          }\n\n          deferred.resolve(cards);\n        });\n\n        return deferred.promise;\n      }\n    };\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .filter('newline', function($sce) {\n\n      return function(text) {\n\n        text = text.replace(/\\n/g, '<br />');\n        return $sce.trustAsHtml(text);\n\n      }\n\n    })\n    .filter('listify', function($sce) {\n\n      return function(text) {\n\n        if ( !text ) return;\n\n        var list = text.split(\"\\n\");\n\n        text = \"<ul>\";\n\n        for (var i = 0; i < list.length; i++) {\n          text += \"<li>\" + list[i] + \"</li>\";\n        }\n\n        text += \"</ul>\"\n\n        return $sce.trustAsHtml(text);\n\n      }\n    });\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($rootScope, $media) {\n    $rootScope.$media = $media;\n    $rootScope.hasBackground = false;\n    $rootScope.customContainer = false;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/pages/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      })\n      .state('storySubmit', {\n        url: '/story/submit',\n        templateUrl: 'app/pages/submitStory/submitStory.html',\n        controller: 'SubmitStoryController',\n        controllerAs: 'scope'\n      })\n      .state('story', {\n        url: '/story/:slug',\n        templateUrl: 'app/pages/story/story.html',\n        controller: 'StoryController',\n        controllerAs: 'scope'\n      })\n      .state('gifts', {\n        url: '/gifts',\n        templateUrl: 'app/pages/gifts/gifts.html',\n        controller: 'GiftsController',\n        controllerAs: 'scope'\n      })\n      .state('gift', {\n        url: '/gift/:slug',\n        templateUrl: 'app/pages/gift/gift.html',\n        controller: 'GiftController',\n        controllerAs: 'scope'\n      })\n      .state('page', {\n        url: '/page/:slug',\n        templateUrl: 'app/pages/static/static.html',\n        controller: 'StaticController',\n        controllerAs: 'scope'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global malarkey:false, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .constant('malarkey', malarkey)\n    .constant('moment', moment);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('lhr70')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig, $httpProvider, $locationProvider, $urlRouterProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 3000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = true;\n    toastrConfig.progressBar = true;\n\n    //service cannot be injected into a config or something\n    var $cookies;\n    angular.injector(['ngCookies']).invoke(['$cookies', function(_$cookies_) {\n      $cookies = _$cookies_;\n    }]);\n\n    // CSFR token for Django\n    $httpProvider.defaults.headers.post  = {\n      'X-CSRFToken': $cookies.get('csrftoken'),\n      'Content-Type': 'application/json'\n    };\n\n    $urlRouterProvider.rule(function($injector, $location) {\n\n      var path = $location.path();\n      var hasTrailingSlash = path[path.length-1] === '/';\n\n      if(hasTrailingSlash) {\n\n        //if last charcter is a slash, return the same url without the slash\n        var newPath = path.substr(0, path.length - 1);\n        return newPath;\n      }\n\n    });\n\n    $locationProvider.html5Mode(true);\n\n\n\n  }\n\n})();\n\nangular.module(\"lhr70\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/cardCta/cta.directive.html\",\"<div class=text-uppercase><div class=cta-border></div><div ng-if=\\\"vm.type == \\'cta\\'\\\"><img src=/static/assets/images/storyCta.png class=cta-img alt=\\\"Share your Heathrow Story\\\"><div class=text-bold>Tell us your story</div><div class=text-light>and receive a birthday gift</div></div><div ng-if=\\\"vm.type == \\'gftCta\\'\\\"><img src=/static/assets/images/giftCta.png class=cta-img alt=\\\"Share your Heathrow Story\\\"><div class=text-bold>See all the gifts</div><div class=text-light>you could receive</div></div></div>\");\n$templateCache.put(\"app/components/cardGift/gift.directive.html\",\"<div class=gift-info><img class=logo ng-src={{vm.gift.logo_module}} alt=\\\"\\\"> <img class=gift-image image-cropper source=vm.gift.image type=vm.gift.className alt={{vm.gift.title}}></div><div class=gift-cta>ADD YOUR STORY FOR A CHANCE TO RECEIVE</div><div class=gift-content>{{vm.gift.title}}</div><!--<div class=\\\"filler\\\"></div>-->\");\n$templateCache.put(\"app/components/cardQuote/quote.directive.html\",\"<div class=quote ng-class=\\\"{\\'is-block\\': vm.block}\\\"><div class=quote--copy><div class=quote-marks>\\\"</div><div class=\\\"lg-text text-capitalize quote-text\\\">{{ vm.story.short_details ? vm.story.short_details : vm.story.pull_quote }}</div></div></div>\");\n$templateCache.put(\"app/components/cardSnippet/snippet.directive.html\",\"<div class=snippet><div class=snippet--copy><div class=\\\"lg-text text-capitalize\\\">{{ vm.story.short_details }}</div></div></div>\");\n$templateCache.put(\"app/components/cardGiftHero/giftHero.directive.html\",\"<div class=gift-info><img class=logo ng-src={{vm.gift.logo_full}} alt={{vm.gift.title}}></div><div class=gift-text><div class=gift-cta>ADD YOUR STORY FOR A CHANCE TO RECEIVE</div><div class=gift-content>{{vm.gift.title}}</div></div><img class=gift-image image-cropper source=vm.gift.image type=vm.gift.className alt=\\\"\\\"> <!--<div class=\\\"filler\\\"></div>-->\");\n$templateCache.put(\"app/components/cardStory/story.directive.html\",\"<div class=content><div class=story--copy><div class=story--from>LHR<div class=icon-plain></div></div><div class=lhr-gradient-text-lg>{{ vm.story.title }}</div></div></div><!--<div class=\\\"filler\\\"></div>-->\");\n$templateCache.put(\"app/components/cards/cards.directive.html\",\"<div ng-if=vm.cards masonary-grid card-parallax class=jig-grid><div ng-repeat=\\\"card in vm.cards track by $index\\\" class=card ng-class=card.className ng-style=card.background><a href=/story/{{card.slug}}><quote-block story=card ng-if=\\\"card.className==\\'qt\\'\\\" block=true></quote-block><snippet-block story=card ng-if=\\\"card.className==\\'sn\\'\\\"></snippet-block><cta-block type=card.className ng-if=\\\"card.className==\\'cta\\' || card.className==\\'gftCta\\'\\\"></cta-block><story-block story=card ng-if=\\\"card.className==\\'sm\\' || card.className==\\'lg\\' \\\"></story-block></a><a href=/gift/{{card.slug}}><gift-block gift=card ng-if=\\\"card.className==\\'gft\\' || card.className==\\'gftLg\\' || card.className==\\'gftSm\\'|| card.className==\\'gftHero\\'\\\"></gift-block></a></div></div>\");\n$templateCache.put(\"app/components/carousel/carousel.directive.html\",\"<div class=carousel><div class=carousel-inner><img ng-repeat=\\\"(key, value) in images\\\" ng-src={{images[key]}} on-finish-render=ngRepeatFinished></div><nav class=carousel-navigation><button class=carousel-prev></button> <button class=carousel-next></button><div class=carousel-pageinfo-wrapper><div class=carousel-pageinfo><span class=carousel-current>{{currentSlide + 1}}</span> <span class=carousel-divider>/</span> <span class=carousel-max>{{images.length}}</span></div></div></nav></div>\");\n$templateCache.put(\"app/components/footer/footer.directive.html\",\"<footer class=footer><div class=footer-content><div class=footer-ctas><div><a href=/story/1>How it works</a></div><div><a href=#>Terms &amp; Conditions</a></div></div><img class=footer-logo src=/static/assets/images/logo_up_and_down.png alt=\\\"Heathrow Logo\\\"></div></footer>\");\n$templateCache.put(\"app/components/giftContent/giftContent.directive.html\",\"<div class=giftdetail-wrapper><div class=giftdetail-title-wrapper><div class=journey-from ng-if=vm.gift.heathrow_origin>LHR<div class=icon-plane></div></div><h1 class=giftdetail-title><span class=giftdetail-title-sub>{{vm.gift.title}}</span> <span class=giftdetail-title-copy>{{vm.gift.title}}</span></h1></div><div class=giftdetail-inner><share></share><div class=giftdetail-content><section class=giftdetail-details-wrapper><section class=giftdetail-details><p class=giftdetail-paragraph>{{vm.gift.description}}</p></section><section class=giftdetail-carousel ng-if=\\\"vm.gift.additional_images.length > 1\\\"><carousel images=vm.gift.additional_images></carousel></section><section class=giftdetail-image ng-if=\\\"vm.gift.additional_images.length === 1\\\"><img ng-src={{vm.gift.additional_images[0]}}></section><h2 class=giftdetail-subtitle>This gift includes</h2><section class=giftdetail-included ng-if=vm.gift.included><p class=giftdetail-paragraph ng-bind-html=\\\"vm.gift.included | listify\\\"></p></section><h2 class=giftdetail-subtitle>Terms &amp; Conditions</h2><section class=giftdetail-terms ng-if=vm.gift.terms><p class=giftdetail-paragraph>{{vm.gift.terms}}</p></section></section></div></div></div>\");\n$templateCache.put(\"app/components/giftHeader/giftHeader.directive.html\",\"<div class=gift-header><div class=gift-header-logo><img ng-src={{logo}}></div><div class=gift-header-image><img image-cropper source=image type=\\\"\\'header-image\\'\\\" ng-src={{image}}></div></div>\");\n$templateCache.put(\"app/components/gifts/gifts.directive.html\",\"<div ng-if=vm.cards masonary-grid card-parallax class=\\\"jig-grid page-gifts\\\"><div ng-repeat=\\\"card in vm.cards track by $index\\\" class=card ng-class=card.className ng-style=card.background><a href=/gift/{{card.slug}}><gift-hero-block ng-if=\\\"card.className == \\'gftHero\\'\\\" gift=card><gift-block ng-if=\\\"card.className != \\'gftHero\\'\\\" gift=card></a></div></div>\");\n$templateCache.put(\"app/components/herobox/herobox.html\",\"<div class=logo-box><img src=/static/assets/images/heath70_logo.png alt=\\\"70th anniversary logo\\\"></div><div class=hero-box ng-class=\\\"{\\'has-content\\': hero.text.content}\\\"><div class=hero-box--text><div class=hero-box--text-sm ng-repeat=\\\"line in hero.text.beforeHero\\\">{{line}}</div><div class=hero-box--text-md>{{hero.subTitle}}</div><h1 class=hero-box--text-lg ng-class=\\\"{\\'hero-box--text-lg--has-sub-title\\': hero.subTitle}\\\">{{hero.title}}</h1><div class=hero-box--text-sm ng-repeat=\\\"line in hero.text.afterHero\\\">{{line}}</div></div></div><div class=\\\"success-box--text hero-box--content\\\" ng-repeat=\\\"line in hero.text.content\\\">{{line}}</div>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<nav><input type=checkbox id=hamburger><label class=menuicon for=hamburger ng-push-menu=menu><span></span></label><ng-slide-push-menu id=menu position=right><a href=# class=active>Read the Stories</a> <a href=#>See all Gifts</a> <a href=#>Find Plaques</a></ng-slide-push-menu></nav><nav class=navbar><div class=lhs><div class=nav--logo>Heathrow 70\\'th Anniversary</div><div class=nav--story-info ng-if=isStoryPage><div class=nav--story-primary><span class=nav--story-from>LHR</span> <span class=icon-plane></span> <span class=nav--story-title>{{storyInfo.title}}</span></div><div class=nav--story-secondary>{{storyInfo.date}}</div></div></div><div class=rhs><a class=\\\"btn btn--hero\\\" href=#>Add your story<span class=icon-plane></span></a></div></nav><menu></menu>\");\n$templateCache.put(\"app/components/pageContent/pageContent.directive.html\",\"<div class=static-wrapper><div class=static-title-wrapper><h1 class=static-title>{{vm.page.title}}</h1></div><div class=static-inner><div class=static-content><section class=static-details-wrapper><section class=static-details ng-bind-html=getSafeContent(vm.page.content)></section></section></div></div></div>\");\n$templateCache.put(\"app/components/share/share.directive.html\",\"<div class=story-share-wrapper><div class=story-share-container><button class=story-share-btn><span class=story-share-copy>SHARE</span></button></div></div>\");\n$templateCache.put(\"app/components/storyContent/storyContent.directive.html\",\"<div class=story-wrapper><div class=story-title-wrapper><div class=journey-from ng-if=vm.story.heathrow_origin>LHR<div class=icon-plane--grey></div></div><h1 class=story-title>{{vm.story.title}}</h1></div><div class=story-inner><share></share><div class=story-content><section class=story-details-wrapper><section class=story-details><p class=story-paragraph ng-if=hasField(vm.story.soundcloud_id)><iframe width=100% height=166 scrolling=no frameborder=no ng-src={{getSoundcloudUrl(vm.story.soundcloud_id)}}></iframe></p><p class=story-paragraph ng-if=hasCopy(vm.story.details) ng-bind-html=getSafeHtml(getFirstParagraph(vm.story.details))></p><div class=qt ng-if=vm.story.pull_quote><quote-block story=vm.story></quote-block></div><p class=story-paragraph ng-repeat=\\\"paragraph in getOtherParagraphs(vm.story.details) track by $index\\\" ng-bind-html=getSafeHtml(paragraph)></p></section><div class=story-author><span class=story-year>{{vm.story.trip_year}}</span> <span class=story-name>{{vm.story.person.name}}</span></div></section></div></div></div>\");\n$templateCache.put(\"app/components/storyHeader/storyHeader.directive.html\",\"<div class=story-header ng-class=\\\"{\\'is-playing-video\\': videoActive}\\\"><div class=story-hero-image style={{getBackground(vm.story.image)}} ng-if=vm.story.image><button class=\\\"story-hero-play-btn btn\\\" ng-click=playVideo() ng-if=hasVideo()><i class=story-hero-play-icon></i><span class=story-hero-play-copy>play video</span></button></div><div class=story-video ng-class=\\\"{\\'is-playing\\': videoActive}\\\"><div id=player></div></div></div>\");\n$templateCache.put(\"app/components/successbox/successbox.html\",\"<div class=logo-box><img src=/static/assets/images/heath70_logo.png alt=\\\"70th anniversary logo\\\"></div><div class=hero-box><div class=hero-box--text><div class=success-box--text-md>Submission Complete</div><h1 class=success-box--text-lg>Thanks!</h1></div></div><div class=success-box--text>Thank you for being a part of our 70th birthday.<br></div><div class=success-box--text>You\\'re now elegable for one of our great birthday gifts.<br>These will be ready for unrapping from 31st May.<br></div><div class=success-box--text>In the mean time why not read <a class=success-link href=/ >some more stories</a><br>from the last 70 years.</div>\");\n$templateCache.put(\"app/pages/gift/gift.html\",\"<div class=gift><div class=container><gift-header image=scope.gift.image logo=scope.gift.logo_full></gift-header><gift-content gift=scope.gift></gift-content></div><div class=cta><cta-block type=\\\"\\'cta\\'\\\"></cta-block></div></div>\");\n$templateCache.put(\"app/pages/gifts/gifts.html\",\"<ng-include src=\\\"\\'app/components/herobox/herobox.html\\'\\\"></ng-include><gifts-block ng-if=scope.cards cards=scope.cards></gifts-block>\");\n$templateCache.put(\"app/pages/main/main.html\",\"<div class=homepage><ng-include src=\\\"\\'app/components/herobox/herobox.html\\'\\\"></ng-include><cards-block ng-if=main.cards cards=main.cards></cards-block></div>\");\n$templateCache.put(\"app/pages/static/static.html\",\"<div class=static><div class=container><page-content page=scope.page></page-content></div></div>\");\n$templateCache.put(\"app/pages/story/story.html\",\"<div class=story><div class=container><story-header story=scope.story></story-header><story-content story=scope.story></story-content></div><div class=cta><cta-block type=\\\"\\'cta\\'\\\"></cta-block></div></div>\");\n$templateCache.put(\"app/pages/submitStory/submitStory.html\",\"<div class=forms ng-hide=scope.isSubmitted><ng-include src=\\\"\\'app/components/herobox/herobox.html\\'\\\"></ng-include><form role=form name=form id=contact-form class=form-journey-info novalidate><div class=form-group><div class=question-number><div ng-if=\\\"scope.story.heathrow_origin === null\\\">1</div><div ng-if=\\\"scope.story.heathrow_origin !== null\\\">✓</div></div><label for=destination class=form-helper-text>To start with, were you flying from or to Heathrow?</label><div class=switch><div class=option ng-class=\\\"{\\'active\\':scope.story.heathrow_origin !== null && scope.story.heathrow_origin === true}\\\" ng-click=\\\"scope.story.heathrow_origin = true\\\">From</div><div class=option ng-class=\\\"{\\'active\\':scope.story.heathrow_origin !== null && scope.story.heathrow_origin === false}\\\" ng-click=\\\"scope.story.heathrow_origin = false\\\">To</div></div></div><!--div.form-group>.question-number+label.form-helper-text--><div class=form-group ng-class=\\\"{\\'active\\': scope.story.destination}\\\"><div class=question-number><div ng-show=!scope.story.destination>2</div><div ng-show=scope.story.destination>✓</div></div><label for=destination class=form-helper-text>Do you Remember where you were flying {{scope.story.heathrow_origin ? \\\"to\\\" : \\\"from\\\"}}?</label><input type=text class=form-control name=destination id=destination placeholder=\\\"eg LAX or Paris\\\" ng-model=scope.story.destination></div><div class=\\\"form-group form-group--lg\\\" ng-class=\\\"{\\'active\\': scope.story.details}\\\"><div class=question-number><div ng-if=!scope.story.details>3</div><div ng-if=scope.story.details>✓</div></div><label for=details class=required ng-class=\\\"{\\'to-fix\\': form.details.$error.required && form.details.$dirty}\\\"><div class=form-helper-text>What was meaningful about this trip?</div></label><textarea class=form-control name=details id=details placeholder=\\\"{{(form.details.$error.required && form.details.$dirty) ? \\'Please tell us your story\\' : \\'TELL US YOUR STORY (500 words max)\\'}}\\\" ng-model=scope.story.details required></textarea></div><div class=form-group><div class=question-number><div ng-if=\\\"!scope.trip_date.year && !scope.trip_date.month && !scope.trip_date.date\\\">4</div><div ng-if=\\\"scope.trip_date.year || scope.trip_date.month || scope.trip_date.date\\\">✓</div></div><label for=\\\"\\\" class=form-helper-text>Do you remember the date?</label><div class=select-row><div class=form-control><div class=lhr-select ng-class=\\\"{\\'active\\': scope.trip_date.year}\\\"><select ng-model=scope.trip_date.year ng-options=\\\"year for year in scope.dateSelector.years() | orderBy: year:yearOrder\\\" class=form-control><option value=\\\"\\\" disabled>Year</option></select></div><div class=lhr-select ng-class=\\\"{\\'active\\': scope.trip_date.month}\\\"><select ng-model=scope.trip_date.month ng-options=\\\"month for month in scope.dateSelector.months()\\\" class=form-control><option value=\\\"\\\" disabled>Month</option></select></div><div class=lhr-select ng-class=\\\"{\\'active\\': scope.trip_date.day}\\\"><select ng-model=scope.trip_date.day ng-options=\\\"day for day in scope.dateSelector.days()\\\" class=form-control><option value=\\\"\\\" disabled>Day</option></select></div></div></div></div><div class=form-group><div class=question-number><div ng-if=!scope.story.terminal>5</div><div ng-if=scope.story.terminal>✓</div></div><label class=form-helper-text>What about the terminal?</label><div class=form-terminal-selector><div class=option ng-click=\\\"scope.story.terminal=\\'T1\\'\\\" ng-class=\\\"{\\'active\\': scope.story.terminal==\\'T1\\'}\\\">1</div><div class=option ng-click=\\\"scope.story.terminal=\\'T2\\'\\\" ng-class=\\\"{\\'active\\': scope.story.terminal==\\'T2\\'}\\\">2</div><div class=option ng-click=\\\"scope.story.terminal=\\'T3\\'\\\" ng-class=\\\"{\\'active\\': scope.story.terminal==\\'T3\\'}\\\">3</div><div class=option ng-click=\\\"scope.story.terminal=\\'T4\\'\\\" ng-class=\\\"{\\'active\\': scope.story.terminal==\\'T4\\'}\\\">4</div><div class=option ng-click=\\\"scope.story.terminal=\\'T5\\'\\\" ng-class=\\\"{\\'active\\': scope.story.terminal==\\'T5\\'}\\\">5</div></div></div><div class=form-group><div class=question-number><div ng-if=!scope.image>6</div><div ng-if=scope.image>✓</div></div><label for=\\\"\\\" class=form-helper-text>Have you got an image?<br>Please share!</label><img class=image--add ng-show=!scope.image src=/assets/icons/add-photo.png ngf-select ng-model=scope.image accept=image/* alt=\\\"add image\\\"> <img class=image--added ng-show=scope.image ng-src=\\\"{{scope.image| ngfDataUrl}}\\\" alt=image><div class=image--options ng-show=scope.image><a class=\\\"image--option-btn success\\\" ngf-select ng-model=scope.image accept=image/*>Change Image</a> <a class=\\\"image--option-btn danger\\\" ng-click=\\\"scope.image = null\\\">Remove Image</a></div></div></form><form role=form name=form2 class=form-person-info novalidate><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.title}\\\"><label for=title class=required ng-class=\\\"{\\'to-fix\\': form2.title.$error.required && form2.title.$dirty}\\\"><div class=form-helper-text>Your Title</div></label><div class=lhr-select><select name=title id=title class=form-control required ng-model=scope.story.person.title><option value=\\\"\\\" disabled>{{(form2.title.$error.required && form2.title.$dirty) ? \\'Please choose a title\\' : \\'Choose\\'}}</option><option value=Mr>Mr</option><option value=Miss selected>Miss</option><option value=Mrs>Mrs</option></select></div></div><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.first_name}\\\"><label for=FirstName class=required ng-class=\\\"{\\'to-fix\\': form2.FirstName.$error.required && form2.FirstName.$dirty}\\\"><div class=form-helper-text>Your First name</div></label><input type=text class=form-control name=FirstName id=FirstName ng-model=scope.story.person.first_name placeholder=\\\"{{(form2.FirstName.$error.required && form2.FirstName.$dirty) ? \\'Please tell us your First name\\' : \\'\\'}}\\\" required></div><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.last_name}\\\"><label for=LastName class=required ng-class=\\\"{\\'to-fix\\': form2.LastName.$error.required && form2.LastName.$dirty}\\\"><div class=form-helper-text>Your Last Name</div></label><input type=text class=form-control name=LastName id=LastName ng-model=scope.story.person.last_name placeholder=\\\"{{(form2.LastName.$error.required && form2.LastName.$dirty) ? \\'Please tell us your Last name\\' : \\'\\'}}\\\" required></div><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.email_address}\\\"><label for=EmailAddress class=required ng-class=\\\"{\\'to-fix\\':( form2.EmailAddress.$error.required || form2.EmailAddress.$error.email)&& form2.EmailAddress.$dirty}\\\"><div class=form-helper-text>Your Email address</div></label><input type=email class=form-control id=EmailAddress name=EmailAddress ng-model=scope.story.person.email_address ng-model-options=\\\"{ updateOn: \\'blur\\' }\\\" placeholder=\\\"{{(form2.EmailAddress.$error.required && form2.EmailAddress.$dirty) ? \\'Please tell us your Email address\\' : \\'\\'}}\\\" required></div><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.postcode}\\\"><label for=postcode class=required ng-class=\\\"{\\'to-fix\\': form2.postcode.$error.required && form2.postcode.$dirty}\\\"><div class=form-helper-text>Your Postcode</div></label><input type=text class=form-control name=postcode id=postcode ng-model=scope.story.person.postcode placeholder=\\\"{{(form2.postcode.$error.required && form2.postcode.$dirty) ? \\'Please tell us your Postcode\\' : \\'\\'}}\\\" required></div><div class=form-group ng-class=\\\"{\\'active\\': scope.story.person.rewards_number}\\\"><label for=rewardsNum class=form-helper-text>Your Heathrow rewards card number</label><input type=text class=form-control name=rewardsNum id=rewardsNum placeholder=\\\"(if you have one)\\\" ng-model=scope.story.person.rewards_number></div></form><form action=\\\"\\\"><div class=\\\"form-group lhr-checkbox\\\"><label>I am over 18 years of age.</label><input type=checkbox required ng-model=scope.checks.isOver18></div><div class=\\\"form-group lhr-checkbox\\\"><label>I have read and agree with the terms and conditions.</label><input type=checkbox required ng-model=scope.checks.termsConditions></div><div class=\\\"form-group lhr-checkbox\\\"><label>I would like to receve updates and offers from Heathrow from time to time.</label><input type=checkbox required ng-model=scope.story.agree_marketing></div></form><button type=submit class=\\\"btn btn-submit form-group\\\" ng-click=\\\"scope.submitForm(form, form2)\\\" ng-class=\\\"{\\'disabled\\':!scope.checks.isOver18 && !scope.checks.termsConditions}\\\"><div class=btn-text>Add Your Story</div><div class=icon-plane-takeoff></div></button></div><ng-include ng-show=scope.isSubmitted src=\\\"\\'app/components/successbox/successbox.html\\'\\\"></ng-include>\");}]);"],"sourceRoot":"/source/"}